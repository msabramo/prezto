#
# Executes commands at the start of an interactive session.
#
# Authors:
#   Sorin Ionescu <sorin.ionescu@gmail.com>
#

# Source Prezto.
if [[ -s "${ZDOTDIR:-$HOME}/.zprezto/init.zsh" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"
fi

# Customize to your needs...

# BSD ls colors
export LSCOLORS='ExGxCxDxCxegedabagacad'

# BSD ls options
alias ls='ls -FG'

# GNU ls colors
export LS_COLORS="di=34;01:ln=36;01:so=32:pi=33:ex=31:bd=36;01:cd=33;01:su=31;40;07:sg=36;40;07:tw=32;40;07:ow=33;40;07"

# Zsh completion colors
zstyle ':completion:*:default' list-colors ${(s.:.)LS_COLORS}

# PATH
export PATH=~/bin:/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.3/bin:/Library/Frameworks/Python.framework/Versions/3.2/bin:/usr/local/bin:/usr/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin

# Python pip
export PIP_DOWNLOAD_CACHE=~/.pip/download-cache

# Python virtualenvwrapper
export WORKON_HOME=~/python/virtualenvs
source $(which virtualenvwrapper.sh)

# If a virtualenv activated, reactivate to get its path mods back
if [ ! -z $VIRTUAL_ENV ]; then
  source $VIRTUAL_ENV/bin/activate
fi

# export PYTHONSTARTUP=~/.pythonrc.py
alias python='PYTHONSTARTUP=~/.pythonrc.py python'

alias gb='git branch -v'
alias gwho='git shortlog -n -s --no-merges'
alias gws='git status --short --branch'
alias ipy='ipython'
alias mkve='mkvirtualenv'
alias psd='pserve development.ini'
alias psdl='pserve development_local.ini'
alias py='python'
alias rerc='source ~/.zshrc'
alias sba='source bin/activate'

# Make Ctrl-Left and Ctrl-Right go backward/forward by words
# Sorin won't accept PR for prezto
# See: https://github.com/sorin-ionescu/prezto/issues/278
bindkey "^[[1;5D" emacs-backward-word
bindkey "^[[1;5C" emacs-forward-word

# Make up and down arrows only use local history
# (don't share history from other zsh sessions - e.g.: tabs)
# from http://superuser.com/questions/446594/separate-up-arrow-lookback-for-local-and-global-zsh-history
bindkey "${key_info[Up]}" up-line-or-local-history
bindkey "${key_info[Down]}" down-line-or-local-history

up-line-or-local-history() {
    zle set-local-history 1
    zle up-line-or-history
    zle set-local-history 0
}
zle -N up-line-or-local-history
down-line-or-local-history() {
    zle set-local-history 1
    zle down-line-or-history
    zle set-local-history 0
}
zle -N down-line-or-local-history
